<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Bir Marul Hikayesi ğŸ¥¬ â€“ Gala Gecesi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  
  <meta id="theme-color-meta" name="theme-color" content="#8f0b1b">

  <link
    href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;600&family=Poppins:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      /* Renk DeÄŸiÅŸkenleri */
      --curtain-red: #8f0b1b;
      --movie-dark: #1a1621;
      
      --ticket-bg: #fbf6ec;
      --ticket-border: #e4dbcf;
      --ticket-text: #22202a;
      --ticket-soft: #6c6674;
      --cc-accent: #f5b36b;
      --cc-accent-soft: #f07171;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    /* 2. HTML ve BODY RENGÄ° VE GEÃ‡Ä°Å AYARLARI */
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: "Poppins", sans-serif;
      color: #f5f1ff;
      
      /* BaÅŸlangÄ±Ã§ta KÄ±rmÄ±zÄ± */
      background-color: var(--curtain-red);
      
      /* Renk deÄŸiÅŸimi 1.5 saniye sÃ¼rsÃ¼n */
      transition: background-color 1.5s ease-in-out;
    }

    /* 3. PERDE AÃ‡ILINCA BU SINIF DEVREYE GÄ°RECEK (JS Ä°LE) */
    body.dark-mode {
      background-color: var(--movie-dark) !important;
    }

    .cinema {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
    }

    .screen-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      /* EkranÄ±n arkasÄ± da baÅŸlangÄ±Ã§ta ÅŸeffaf/kÄ±rmÄ±zÄ± uyumlu olsun */
      background: transparent; 
      box-shadow:
        0 0 40px rgba(0, 0, 0, 0.9),
        0 0 80px rgba(0, 0, 0, 0.95);
    }
    
    /* Film baÅŸlayÄ±nca arkaya hafif bir karanlÄ±k derinlik ekle */
    body.dark-mode .screen-wrapper {
        background: radial-gradient(circle at top, #2a2233 0, #1a1621 60%);
        transition: background 1.5s ease;
    }

    .screen {
      position: absolute;
      inset: 0;
      padding: min(3vw, 26px);
      padding-bottom: 160px;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      z-index: 1;
    }

    @media (max-width: 768px) {
      .screen {
        padding: 14px;
        padding-top: 40px;
        padding-bottom: 80px;
        align-items: center;
      }
    }

    .screen-inner {
      position: relative;
      width: 100%;
      max-width: 1100px;
      aspect-ratio: 16 / 9;
      border-radius: 22px;
      background: #000;
      overflow: hidden;
      box-shadow:
        0 24px 45px rgba(0, 0, 0, 0.95),
        0 0 60px rgba(0, 0, 0, 0.9);
      z-index: 1;
    }

    .screen-video {
      position: absolute;
      inset: 0;
      background: #000;
      border-radius: inherit;
      overflow: hidden;
      z-index: 1;
    }

    .screen-video video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      background-color: transparent;
    }

    /* BUTONLAR VE DÄ°ÄER ELEMENTLER */
    .top-start {
      position: absolute;
      top: 14px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease;
    }

    .top-start.show {
      opacity: 1;
      pointer-events: auto;
    }

    .top-start-btn {
      border: none;
      outline: none;
      border-radius: 999px;
      padding: 8px 18px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      font-family: inherit;
      background: linear-gradient(135deg, #f07171, #f5b36b);
      color: #190b0b;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.6);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .custom-controls {
      position: absolute;
      left: 18px;
      right: 18px;
      bottom: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(7,5,14,0.96), rgba(22,15,32,0.96));
      border: 1px solid rgba(255, 245, 230, 0.18);
      box-shadow: 0 14px 32px rgba(0,0,0,0.75);
      display: flex;
      align-items: center;
      gap: 10px;
      color: #f7f2ff;
      font-size: 0.78rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease, transform 0.25s ease;
      transform: translateY(6px);
      z-index: 6;
    }

    .custom-controls.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .cc-btn {
      border: none;
      background: none;
      color: inherit;
      cursor: pointer;
      font-size: 0.9rem;
    }
    
    .cc-progress-wrap {
      flex: 1;
      display: flex;
      align-items: center;
    }

    .cc-progress-bg {
      position: relative;
      width: 100%;
      height: 4px;
      border-radius: 999px;
      background: rgba(255,255,255,0.16);
      overflow: hidden;
      cursor: pointer;
    }

    .cc-progress-bar {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 0%;
      background: linear-gradient(90deg, var(--cc-accent), var(--cc-accent-soft));
    }

    .cc-right {
        display: flex;
        gap: 8px;
        align-items: center;
    }

    .viewer-scene {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: min(1100px, 100vw);
      z-index: 2;
      pointer-events: none;
      display: flex;
      justify-content: center;
      align-items: flex-end;
    }
    
    .viewer-scene img {
        width: 100%;
        height: auto;
        display: block;
        image-rendering: pixelated;
        filter: brightness(1.08);
        transition: filter 0.8s;
    }
    
    body.dark-mode .viewer-scene img {
        /* IÅŸÄ±klar kapanÄ±nca izleyiciler de kararÄ±r */
        filter: brightness(0.5);
    }

    /* OVERLAYS */
    .pause-overlay, .end-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.75);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease;
      z-index: 4;
    }
    .pause-overlay.show, .end-overlay.show { opacity: 1; pointer-events: auto; }

    .pause-card, .end-card {
      background: rgba(10, 8, 18, 0.92);
      border-radius: 18px;
      padding: 18px 22px;
      border: 1px solid rgba(255, 245, 230, 0.15);
      text-align: center;
      max-width: 320px;
    }
    
    .end-btn {
        padding: 8px 16px;
        border-radius: 20px;
        border: none;
        margin: 5px;
        cursor: pointer;
    }
    .end-btn.primary { background: #f5b36b; color: #000; }
    .end-btn.ghost { background: transparent; border: 1px solid #fff; color: #fff; }

    /* PERDE */
    .curtain {
      position: absolute;
      inset: 0;
      display: flex;
      z-index: 3;
      pointer-events: none;
    }

    .curtain-panel {
      flex: 1;
      height: 100%;
      background: repeating-linear-gradient(90deg, #8f0b1b, #8f0b1b 14px, #c52134 14px, #c52134 28px);
      box-shadow: inset 0 0 45px rgba(0,0,0,0.8);
      transition: transform 1.5s cubic-bezier(0.16, 0.84, 0.3, 1);
    }
    
    .curtain.open .curtain-panel.left { transform: translateX(-100%); }
    .curtain.open .curtain-panel.right { transform: translateX(100%); }

    /* BÄ°LET STÄ°LLERÄ° */
    .ticket-layer {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
      pointer-events: auto;
    }

    .ticket-visual {
      position: relative;
      width: min(760px, 96vw);
      display: flex;
      filter: drop-shadow(0 20px 40px rgba(0,0,0,0.8));
    }
    
    .ticket-main-part {
        flex: 1.3;
        background: var(--ticket-bg);
        color: var(--ticket-text);
        border-radius: 18px 0 0 18px;
        padding: 20px;
        border-right: 1px dashed #ccc;
    }
    
    .ticket-stub-wrap {
        flex: 0.55;
        position: relative;
    }
    
    .ticket-stub {
        background: var(--ticket-bg);
        color: var(--ticket-text);
        border-radius: 0 18px 18px 0;
        height: 100%;
        padding: 15px;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .ticket-gone {
        animation: ticketFade 0.5s forwards;
        pointer-events: none;
    }
    @keyframes ticketFade { to { opacity: 0; transform: translateY(50px); } }

    .bottom-caption {
      position: absolute;
      bottom: 20px;
      left: 0; right: 0;
      text-align: center;
      font-size: 0.75rem;
      opacity: 0.8;
      pointer-events: none;
      z-index: 6;
      transition: opacity 0.5s;
    }
    .bottom-caption.hide { opacity: 0; }

    /* Mobil uyumlar */
    @media (max-width: 600px) {
        .ticket-title { font-size: 1.5rem; }
        .ticket-rows { font-size: 0.8rem; }
    }
  </style>
</head>
<body>

  <div class="cinema">
    <div class="screen-wrapper">
      <div class="curtain" id="curtain">
        <div class="curtain-panel left"></div>
        <div class="curtain-panel right"></div>
      </div>

      <div class="screen">
        <div class="screen-inner">
          <div class="screen-video" id="screen-video">
            <video id="love-film" playsinline webkit-playsinline preload="metadata" poster="poster.png">
              <source src="film.mp4" type="video/mp4" />
            </video>
          </div>

          <div class="top-start" id="top-start">
            <button class="top-start-btn">â–¶ Filmi BaÅŸlat</button>
          </div>

          <div class="custom-controls" id="custom-controls">
            <button class="cc-btn" id="btn-play">â–¶</button>
            <div class="cc-progress-wrap">
              <div class="cc-progress-bg" id="cc-progress-bg">
                <div class="cc-progress-bar" id="cc-progress"></div>
              </div>
            </div>
            <div class="cc-right">
                <span class="cc-time" id="cc-time">0:00</span>
                <button class="cc-btn" id="btn-fullscreen">â›¶</button>
            </div>
          </div>
          
          <div class="pause-overlay" id="pause-overlay">
              <div class="pause-card">
                  <h3>REKLAM ARASI</h3>
                  <p>Minik bir mola...</p>
              </div>
          </div>
          
          <div class="end-overlay" id="end-overlay">
              <div class="end-card">
                  <h3>FÄ°LM BÄ°TTÄ° ğŸ¬</h3>
                  <div class="end-actions">
                      <button class="end-btn primary" id="btn-rewatch">Tekrar Ä°zle</button>
                      <button class="end-btn ghost" id="btn-save-ticket">Bileti Sakla</button>
                  </div>
              </div>
          </div>
        </div>
      </div>

      <div class="viewer-scene">
        <img src="salon.png" alt="Cinema" />
      </div>

      <div class="ticket-layer" id="ticket-layer">
        <div class="ticket-visual" id="ticket-main">
          <div class="ticket-main-part">
            <small style="letter-spacing:2px; color:#666;">MANITA CINEMA</small>
            <h1 class="ticket-title" style="font-family:'Dancing Script'; margin:5px 0;">Bir Marul Hikayesi ğŸ¥¬</h1>
            <p style="font-size:0.85rem; color:#666;">Bu yÄ±lÄ±n en romantik yapÄ±mÄ±</p>
            <hr style="border:0; border-top:1px solid #ddd; margin:10px 0;">
            <div style="display:flex; justify-content:space-around; text-align:center;">
                <div><b>Salon</b><br>26</div>
                <div><b>SÄ±ra</b><br>Yan Yana â¤</div>
            </div>
          </div>
          <div class="ticket-stub-wrap" id="ticket-stub">
            <div class="ticket-stub">
                <div>
                    <small>TARÄ°H</small><br>
                    <b>01.01.2026</b>
                </div>
                <div style="margin-top:20px;">
                    â¬‡ï¸<br><small>AÅŸaÄŸÄ± Ã‡ek</small>
                </div>
            </div>
            <div id="ticket-drag-zone" style="position:absolute; inset:0; cursor:grab;"></div>
          </div>
        </div>
      </div>
      
      <div class="bottom-caption" id="bottom-caption">
          Bileti koparÄ±nca perde aÃ§Ä±lacak... ğŸ¿
      </div>
    </div>
  </div>

  <audio id="curtain-sound" src="curtain.mp3" preload="auto"></audio>

  <script>
    (function () {
      const curtain = document.getElementById("curtain");
      const ticketLayer = document.getElementById("ticket-layer");
      const ticketStub = document.getElementById("ticket-stub");
      const ticketMain = document.getElementById("ticket-main");
      const dragZone = document.getElementById("ticket-drag-zone");
      const bottomCaption = document.getElementById("bottom-caption");
      const curtainSound = document.getElementById("curtain-sound");
      const video = document.getElementById("love-film");
      const metaTheme = document.getElementById("theme-color-meta");
      
      /* Video Kontrolleri */
      const customControls = document.getElementById("custom-controls");
      const btnPlay = document.getElementById("btn-play");
      const topStart = document.getElementById("top-start");
      const btnFullscreen = document.getElementById("btn-fullscreen");
      const pauseOverlay = document.getElementById("pause-overlay");
      const endOverlay = document.getElementById("end-overlay");
      const btnRewatch = document.getElementById("btn-rewatch");

      let dragging = false;
      let startY = 0;
      let currentY = 0;
      let maxDrag = 150;

      // 1. TEMA DEÄÄ°ÅTÄ°RME FONKSÄ°YONU
      function switchThemeToDark() {
          // CSS sÄ±nÄ±fÄ±nÄ± ekle (Arka planÄ± siyah yapar)
          document.body.classList.add('dark-mode');
          
          // TarayÄ±cÄ± Ã¼st Ã§ubuÄŸunu siyah yap
          if(metaTheme) metaTheme.setAttribute('content', '#1a1621');
      }

      function detachTicket() {
        ticketMain.classList.add("ticket-gone");
        setTimeout(() => { ticketLayer.style.display = "none"; }, 500);
        
        // Perdeyi aÃ§
        curtain.classList.add("open");
        if(bottomCaption) bottomCaption.classList.add("hide");
        
        // Ses Ã§al
        if(curtainSound) curtainSound.play().catch(()=>{});

        // Buton gÃ¶ster
        topStart.classList.add("show");
        
        // *** RENK DEÄÄ°ÅÄ°MÄ°NÄ° TETÄ°KLE ***
        switchThemeToDark();
      }

      // Drag Logic
      function onPointerDown(e) {
        dragging = true;
        startY = e.clientY || e.touches[0].clientY;
        ticketStub.style.transition = 'none';
      }
      function onPointerMove(e) {
        if(!dragging) return;
        let y = (e.clientY || e.touches[0].clientY) - startY;
        if(y < 0) y = 0;
        if(y > maxDrag) y = maxDrag;
        currentY = y;
        ticketStub.style.transform = `translateY(${y}px)`;
      }
      function onPointerUp() {
        if(!dragging) return;
        dragging = false;
        if(currentY > 100) {
            detachTicket();
        } else {
            ticketStub.style.transition = 'transform 0.3s';
            ticketStub.style.transform = 'translateY(0)';
        }
      }

      dragZone.addEventListener('mousedown', onPointerDown);
      document.addEventListener('mousemove', onPointerMove);
      document.addEventListener('mouseup', onPointerUp);
      
      dragZone.addEventListener('touchstart', onPointerDown);
      document.addEventListener('touchmove', onPointerMove);
      document.addEventListener('touchend', onPointerUp);

      // Video Logic BasitleÅŸtirilmiÅŸ
      function togglePlay() {
          if(video.paused) {
              video.play();
              topStart.classList.remove('show');
              pauseOverlay.classList.remove('show');
              endOverlay.classList.remove('show');
              btnPlay.textContent = "â¸";
              customControls.classList.add("visible");
          } else {
              video.pause();
              pauseOverlay.classList.add('show');
              btnPlay.textContent = "â–¶";
          }
      }

      if(btnPlay) btnPlay.onclick = (e) => { e.stopPropagation(); togglePlay(); };
      if(topStart) topStart.onclick = togglePlay;
      if(pauseOverlay) pauseOverlay.onclick = togglePlay;
      
      if(btnRewatch) btnRewatch.onclick = (e) => {
          e.stopPropagation();
          endOverlay.classList.remove('show');
          video.currentTime = 0;
          video.play();
      };
      
      video.onended = () => {
          endOverlay.classList.add('show');
          customControls.classList.add("visible");
      };
      
      // Fullscreen
      if(btnFullscreen) btnFullscreen.onclick = () => {
          if(video.requestFullscreen) video.requestFullscreen();
          else if(video.webkitEnterFullscreen) video.webkitEnterFullscreen();
      };

    })();
  </script>
</body>
</html>
